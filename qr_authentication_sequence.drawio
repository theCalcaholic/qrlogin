<mxfile host="Electron" modified="2023-05-29T11:15:06.862Z" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.2.8 Chrome/112.0.5615.165 Electron/24.2.0 Safari/537.36" etag="ITW7o4C8Q8N8Myk2sD5g" version="21.2.8" type="device">
  <diagram name="Page-1" id="9361dd3d-8414-5efd-6122-117bd74ce7a7">
    <mxGraphModel dx="1195" dy="699" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1.5" pageWidth="826" pageHeight="1169" background="none" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="69" value="" style="fillColor=#DEE8FF;strokeColor=none" parent="1" vertex="1">
          <mxGeometry x="40" y="10" width="950" height="800" as="geometry" />
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-106" value="" style="fillColor=#e1d5e7;strokeColor=#9673a6;verticalAlign=top;align=left;" vertex="1" parent="1">
          <mxGeometry x="360" y="370" width="290" height="150" as="geometry" />
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-107" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="42" target="6">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="500" y="420" />
              <mxPoint x="500" y="420" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-108" value="&lt;font style=&quot;font-size: 11px;&quot;&gt;poll for authorization&amp;nbsp;&lt;span style=&quot;text-align: left;&quot;&gt;grant&lt;br&gt;&lt;br&gt;&amp;nbsp;with salted hash of clientId&lt;/span&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" vertex="1" connectable="0" parent="DBdPMEEoF_8QgYfEJt55-107">
          <mxGeometry x="-0.2151" relative="1" as="geometry">
            <mxPoint x="13" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-113" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=none;endFill=0;dashed=1;" edge="1" parent="1" source="42" target="66">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="42" value="" style="fillColor=#CC4125;strokeColor=#660000" parent="1" vertex="1">
          <mxGeometry x="430" y="300" width="10" height="280" as="geometry" />
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-90" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;endArrow=classic;endFill=1;" edge="1" parent="1" source="2" target="21">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="670" y="280" />
              <mxPoint x="670" y="280" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-96" value="user scans QR code" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" vertex="1" connectable="0" parent="DBdPMEEoF_8QgYfEJt55-90">
          <mxGeometry x="0.4609" y="1" relative="1" as="geometry">
            <mxPoint x="9" y="-9" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="2" value="" style="fillColor=#CC4125;strokeColor=#660000" parent="1" vertex="1">
          <mxGeometry x="430" y="150" width="10" height="130" as="geometry" />
        </mxCell>
        <mxCell id="3" value="user requests login" style="edgeStyle=elbowEdgeStyle;verticalLabelPosition=top;verticalAlign=bottom;labelPosition=left;align=right;exitX=1;exitY=0.5;exitDx=0;exitDy=0;elbow=vertical;rounded=0;labelBackgroundColor=none;" parent="1" edge="1" source="DBdPMEEoF_8QgYfEJt55-94">
          <mxGeometry x="250" width="100" height="100" as="geometry">
            <mxPoint x="360" y="149.5" as="sourcePoint" />
            <mxPoint x="450" y="149.5" as="targetPoint" />
            <Array as="points">
              <mxPoint x="330" y="150" />
            </Array>
            <mxPoint x="35" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4" value="Client 1 (Browser)" style="shadow=1;fillColor=#A2C4C9;strokeColor=none" parent="1" vertex="1">
          <mxGeometry x="382.5" y="60" width="105" height="50" as="geometry" />
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-109" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" edge="1" parent="1" source="6" target="42">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="470" y="470" />
              <mxPoint x="470" y="470" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-110" value="denied (if no grant available)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" vertex="1" connectable="0" parent="DBdPMEEoF_8QgYfEJt55-109">
          <mxGeometry x="-0.1603" y="-1" relative="1" as="geometry">
            <mxPoint x="-21" y="-6" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-122" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=none;endFill=0;" edge="1" parent="1" source="6" target="DBdPMEEoF_8QgYfEJt55-119">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6" value="" style="fillColor=#CC4125;strokeColor=#660000" parent="1" vertex="1">
          <mxGeometry x="682.5" y="370" width="10" height="200" as="geometry" />
        </mxCell>
        <mxCell id="7" value="Server" style="shadow=1;fillColor=#A2C4C9;strokeColor=none" parent="1" vertex="1">
          <mxGeometry x="635" y="60" width="105" height="50" as="geometry" />
        </mxCell>
        <mxCell id="8" value="" style="edgeStyle=none;endArrow=none;dashed=1" parent="1" source="7" target="6" edge="1">
          <mxGeometry x="522.3350694444446" y="165" width="100" height="100" as="geometry">
            <mxPoint x="597.2588734567901" y="110" as="sourcePoint" />
            <mxPoint x="597.5761959876544" y="165" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-100" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="21" target="DBdPMEEoF_8QgYfEJt55-98">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="740" y="330" />
              <mxPoint x="740" y="330" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-101" value="ask for confirmation + authorization (mobile unlock)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" vertex="1" connectable="0" parent="DBdPMEEoF_8QgYfEJt55-100">
          <mxGeometry x="-0.3293" y="-1" relative="1" as="geometry">
            <mxPoint x="23" y="-9" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-104" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="21" target="6">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="810" y="490" />
              <mxPoint x="810" y="490" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-105" value="send (signed?) user authorization grant&lt;br&gt;&lt;br&gt;for userId+clientId" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" vertex="1" connectable="0" parent="DBdPMEEoF_8QgYfEJt55-104">
          <mxGeometry x="0.1654" relative="1" as="geometry">
            <mxPoint x="23" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-126" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=none;endFill=0;" edge="1" parent="1" source="21">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="925" y="770" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="21" value="" style="fillColor=#CC4125;strokeColor=#660000" parent="1" vertex="1">
          <mxGeometry x="920" y="280" width="10" height="210" as="geometry" />
        </mxCell>
        <mxCell id="22" value="Client 2 (App)" style="shadow=1;fillColor=#A2C4C9;strokeColor=none" parent="1" vertex="1">
          <mxGeometry x="872.5" y="60" width="105" height="50" as="geometry" />
        </mxCell>
        <mxCell id="23" value="" style="edgeStyle=none;endArrow=none;dashed=1" parent="1" source="22" target="21" edge="1">
          <mxGeometry x="864.4878472222224" y="174.99999999999997" width="100" height="100" as="geometry">
            <mxPoint x="924.6527777777778" y="110" as="sourcePoint" />
            <mxPoint x="924.6527777777778" y="260" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="33" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=none;dashed=1" parent="1" source="4" target="2" edge="1">
          <mxGeometry x="460" y="310" width="100" height="100" as="geometry">
            <mxPoint x="460" y="410" as="sourcePoint" />
            <mxPoint x="560" y="310" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="44" value="" style="edgeStyle=none;dashed=1;endArrow=none" parent="1" source="2" target="42" edge="1">
          <mxGeometry x="280" y="300" width="100" height="100" as="geometry">
            <mxPoint x="280" y="400" as="sourcePoint" />
            <mxPoint x="380" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="66" value="" style="fillColor=#CC4125;strokeColor=#660000" parent="1" vertex="1">
          <mxGeometry x="430" y="640" width="10" height="130" as="geometry" />
        </mxCell>
        <mxCell id="71" value="Nextcloud QR Login" style="rounded=1;fontStyle=1;fillColor=#FFD966;strokeColor=none" parent="1" vertex="1">
          <mxGeometry x="50" y="20" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-89" value="Generate client id&#xa;and show as QR code" style="fillColor=#BFC8DB" vertex="1" parent="1">
          <mxGeometry x="350" y="184.71999999999997" width="170" height="60.56" as="geometry" />
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-95" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=none;endFill=0;" edge="1" parent="1" source="DBdPMEEoF_8QgYfEJt55-92" target="DBdPMEEoF_8QgYfEJt55-94">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-92" value="User" style="shadow=1;fillColor=#A2C4C9;strokeColor=none" vertex="1" parent="1">
          <mxGeometry x="120" y="60" width="105" height="50" as="geometry" />
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-99" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=none;endFill=0;" edge="1" parent="1" source="DBdPMEEoF_8QgYfEJt55-94" target="DBdPMEEoF_8QgYfEJt55-98">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-94" value="" style="fillColor=#CC4125;strokeColor=#660000" vertex="1" parent="1">
          <mxGeometry x="167.5" y="130" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-102" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=1 1;" edge="1" parent="1" source="DBdPMEEoF_8QgYfEJt55-98">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="920" y="360" as="targetPoint" />
            <Array as="points">
              <mxPoint x="430" y="360" />
              <mxPoint x="430" y="360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-103" value="confirm and authorize" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" vertex="1" connectable="0" parent="DBdPMEEoF_8QgYfEJt55-102">
          <mxGeometry x="-0.134" y="-2" relative="1" as="geometry">
            <mxPoint x="-179" y="-11" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-124" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=none;endFill=0;" edge="1" parent="1" source="DBdPMEEoF_8QgYfEJt55-98">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="172.5" y="770" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-98" value="" style="fillColor=#CC4125;strokeColor=#660000;" vertex="1" parent="1">
          <mxGeometry x="167.5" y="330" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="75" value="repeat" style="rounded=1;fontStyle=1;fillColor=#FFD966;strokeColor=none" parent="1" vertex="1">
          <mxGeometry x="360" y="370.0035185185186" width="53.75" height="25" as="geometry" />
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-111" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" edge="1" parent="1" source="6" target="42">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="693" y="480" as="sourcePoint" />
            <mxPoint x="470" y="480" as="targetPoint" />
            <Array as="points">
              <mxPoint x="520" y="540" />
              <mxPoint x="520" y="540" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-112" value="granted (if grant available)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" vertex="1" connectable="0" parent="DBdPMEEoF_8QgYfEJt55-111">
          <mxGeometry x="-0.1603" y="-1" relative="1" as="geometry">
            <mxPoint x="-21" y="-6" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="DBdPMEEoF_8QgYfEJt55-119" value="" style="fillColor=#CC4125;strokeColor=#660000" vertex="1" parent="1">
          <mxGeometry x="682.5" y="640" width="10" height="130" as="geometry" />
        </mxCell>
        <mxCell id="74" value="Proceed with login flow" style="fillColor=#BFC8DB" parent="1" vertex="1">
          <mxGeometry x="370" y="680" width="380" height="60.56" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
